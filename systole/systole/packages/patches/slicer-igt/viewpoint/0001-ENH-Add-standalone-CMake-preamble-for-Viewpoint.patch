From 1b61d7020929cce788b2e35577032aba92887689 Mon Sep 17 00:00:00 2001
From: Rafael Palomar <rafael.palomar@ous-research.no>
Date: Fri, 27 Feb 2026 12:06:48 +0100
Subject: [PATCH] ENH: Add standalone CMake preamble for Viewpoint

Add cmake_minimum_required + find_package(Slicer) preamble
so the scripted module can be built standalone against an
installed Slicer.
---
 Viewpoint/CMakeLists.txt | 78 ++++++++++++++++++++++++----------------
 1 file changed, 48 insertions(+), 30 deletions(-)

diff --git a/Viewpoint/CMakeLists.txt b/Viewpoint/CMakeLists.txt
index ff60128..c97ee29 100644
--- a/Viewpoint/CMakeLists.txt
+++ b/Viewpoint/CMakeLists.txt
@@ -1,30 +1,48 @@
-#-----------------------------------------------------------------------------
-set(MODULE_NAME Viewpoint)
-
-#-----------------------------------------------------------------------------
-set(MODULE_PYTHON_SCRIPTS
-  ${MODULE_NAME}.py
-  )
-
-set(MODULE_PYTHON_RESOURCES
-  Resources/Icons/${MODULE_NAME}.png
-  )
-
-#-----------------------------------------------------------------------------
-slicerMacroBuildScriptedModule(
-  NAME ${MODULE_NAME}
-  SCRIPTS ${MODULE_PYTHON_SCRIPTS}
-  RESOURCES ${MODULE_PYTHON_RESOURCES}
-  WITH_GENERIC_TESTS
-  )
-
-#-----------------------------------------------------------------------------
-if(BUILD_TESTING)
-
-  # Register the unittest subclass in the main script as a ctest.
-  # Note that the test will also be available at runtime.
-  slicer_add_python_unittest(SCRIPT ${MODULE_NAME}.py)
-
-  # Additional build-time testing
-  add_subdirectory(Testing)
-endif()
+cmake_minimum_required(VERSION 3.16.3...3.19.7 FATAL_ERROR)
+
+project(Viewpoint)
+
+set(CMAKE_CXX_STANDARD "17")
+
+find_package(Slicer REQUIRED)
+include(${Slicer_USE_FILE})
+
+if(NOT Slicer_QTSCRIPTEDMODULES_LIB_DIR)
+  set(Slicer_QTSCRIPTEDMODULES_LIB_DIR
+    "lib/Slicer-${Slicer_VERSION}/qt-scripted-modules")
+endif()
+if(NOT Slicer_INSTALL_QTSCRIPTEDMODULES_LIB_DIR)
+  set(Slicer_INSTALL_QTSCRIPTEDMODULES_LIB_DIR
+    "lib/Slicer-${Slicer_VERSION}/qt-scripted-modules")
+endif()
+
+#-----------------------------------------------------------------------------
+set(MODULE_NAME Viewpoint)
+
+#-----------------------------------------------------------------------------
+set(MODULE_PYTHON_SCRIPTS
+  ${MODULE_NAME}.py
+  )
+
+set(MODULE_PYTHON_RESOURCES
+  Resources/Icons/${MODULE_NAME}.png
+  )
+
+#-----------------------------------------------------------------------------
+slicerMacroBuildScriptedModule(
+  NAME ${MODULE_NAME}
+  SCRIPTS ${MODULE_PYTHON_SCRIPTS}
+  RESOURCES ${MODULE_PYTHON_RESOURCES}
+  WITH_GENERIC_TESTS
+  )
+
+#-----------------------------------------------------------------------------
+if(BUILD_TESTING)
+
+  # Register the unittest subclass in the main script as a ctest.
+  # Note that the test will also be available at runtime.
+  slicer_add_python_unittest(SCRIPT ${MODULE_NAME}.py)
+
+  # Additional build-time testing
+  add_subdirectory(Testing)
+endif()
-- 
2.52.0

