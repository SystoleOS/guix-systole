From c09c5f9c01fb36eaf588850e0ba51472ab6282a8 Mon Sep 17 00:00:00 2001
From: Rafael Palomar <rafael.palomar@ous-research.no>
Date: Sat, 21 Feb 2026 22:25:40 +0100
Subject: [PATCH] COMP: Add qSlicerBaseQTCore to standalone loadable module
 link deps

---
 CMake/SlicerMacroBuildLoadableModule.cmake | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/CMake/SlicerMacroBuildLoadableModule.cmake b/CMake/SlicerMacroBuildLoadableModule.cmake
index 08aea66f65..7e2d0bf4b3 100644
--- a/CMake/SlicerMacroBuildLoadableModule.cmake
+++ b/CMake/SlicerMacroBuildLoadableModule.cmake
@@ -219,10 +219,12 @@ macro(slicerMacroBuildLoadableModule)
 
   # In the superbuild Slicer_GUI_LIBRARY is set (e.g. qSlicerBaseQTApp).
   # In a system install it is empty; fall back to qSlicerBaseQTGUI directly.
+  # qSlicerBaseQTCore must also be listed explicitly: --as-needed prevents
+  # resolving qSlicerObject symbols transitively through qSlicerBaseQTGUI.
   if(Slicer_GUI_LIBRARY)
     set(_slicer_gui_lib ${Slicer_GUI_LIBRARY})
   else()
-    set(_slicer_gui_lib qSlicerBaseQTGUI)
+    set(_slicer_gui_lib qSlicerBaseQTCore qSlicerBaseQTGUI)
   endif()
 
   # Loadable modules are Qt-based and always need Qt5::Widgets, Qt5::Xml, and
-- 
2.52.0

